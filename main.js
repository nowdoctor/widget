(function(){var jQuery;if(window.jQuery===undefined||window.jQuery.fn.jquery!=='1.7.0'){var script_tag=document.createElement('script');script_tag.setAttribute("type","text/javascript");script_tag.setAttribute("src","http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js");if(script_tag.readyState){script_tag.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){scriptLoadHandler()}}}else{script_tag.onload=scriptLoadHandler}(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(script_tag)}else{jQuery=window.jQuery;main()}function scriptLoadHandler(){jQuery=window.jQuery.noConflict(true);google.maps.event.addDomListener(window,'load',initSearchField);main()}function initSearchField(){var input=document.getElementById('nowdoctor_location');var options={types:['geocode'],componentRestrictions:{country:'gr'}};autocomplete=new google.maps.places.Autocomplete(input,options);google.maps.event.addListener(autocomplete,'place_changed',function(){var place=autocomplete.getPlace();jQuery('#lat2').val(add0(roundNumber(place.geometry.location.lat(),7)));jQuery('#lon2').val(add0(roundNumber(place.geometry.location.lng(),7)));var addresses=place.address_components;jQuery(addresses).each(function(){var object1=jQuery(this);if(object1[0].types[0]=="administrative_area_level_2"){var geo=new google.maps.Geocoder;geo.geocode({'address':object1[0].long_name},function(results,status){if(status==google.maps.GeocoderStatus.OK){myLocation=results[0].geometry.location;jQuery('#lat').val(add0(roundNumber(myLocation.lat(),7)));jQuery('#lon').val(add0(roundNumber(myLocation.lng(),7)))}else{}})}})});var input=document.getElementById('nowdoctor_location');google.maps.event.addDomListener(input,'keydown',function(e){if(e.keyCode==13){if(e.preventDefault){e.preventDefault()}else{e.cancelBubble=true;e.returnValue=false}}})}function roundNumber(num,dec){var result=Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);return result}function add0(number){var result=String(number);var numDec=result.split(".")[1].length;if(numDec<7){var limit=7-numDec;for(var i=0;i<limit;i++){result+="0"}}return result}function _setCurrent($current,$dk){$dk.find('.dk_option_current').removeClass('dk_option_current');$current.addClass('dk_option_current');_setScrollPos($dk,$current)}function _setScrollPos($dk,anchor){var height=anchor.prevAll('li').outerHeight()*anchor.prevAll('li').length;$dk.find('.dk_options_inner').animate({scrollTop:height+'px'},0)}function _closeDropdown($dk){$dk.removeClass('dk_open')}function _openDropdown($dk){var data=$dk.data('dropkick');$dk.find('.dk_options').css({top:$dk.find('.dk_toggle').outerHeight()-1});$dk.toggleClass('dk_open')}function _updateFields(option,$dk,reset){var value,label,data;value=option.attr('data-dk-dropdown-value');label=option.text();data=$dk.data('dropkick');$dk.find('.dk_label').text(label);jQuery('input[name="category"]').val(value);reset=reset||false}function _handleKeyBoardNav(e,$dk){var code=e.keyCode,data=$dk.data('dropkick'),options=$dk.find('.dk_options'),open=$dk.hasClass('dk_open'),current=$dk.find('.dk_option_current'),first=options.find('li').first(),last=options.find('li').last(),next,prev;switch(code){case keyMap.enter:if(open){_updateFields(current.find('a'),$dk);_closeDropdown($dk)}else{_openDropdown($dk)}e.preventDefault();break;case keyMap.up:prev=current.prev('li');if(open){if(prev.length){_setCurrent(prev,$dk)}else{_setCurrent(last,$dk)}}else{_openDropdown($dk)}e.preventDefault();break;case keyMap.down:if(open){next=current.next('li').first();if(next.length){_setCurrent(next,$dk)}else{_setCurrent(first,$dk)}}else{_openDropdown($dk)}e.preventDefault();break;default:break}}function checkArea(){var area=document.getElementById("nowdoctor_location").value;if(area=="Εισάγετε τοποθεσία"){jQuery('#nowdoctor_location').attr('name','')}else{jQuery('#nowdoctor_location').attr('name','search1')}}function main(){jQuery(document).ready(function($){jQuery('form#nowdoctor_main_form').submit(function(){checkArea();if(jQuery('#nowdoctor_location').val()!=""){var str=jQuery('#nowdoctor_location').val();var substr=str.split(',');jQuery('#nowdoctor_location').val(substr[0]);jQuery('#nowdoctor_search2').val(str)}});jQuery('#dk_container_nowdoctor_category').bind('focus.dropkick',function(e){jQuery('#dk_container_nowdoctor_category').addClass('dk_focus')}).bind('blur.dropkick',function(e){jQuery('#dk_container_nowdoctor_category').removeClass('dk_open dk_focus')});jQuery(function(){jQuery('.dk_toggle').live('click',function(e){var $dk=jQuery(this).parents('.dk_container').first();_openDropdown($dk);if("ontouchstart"in window){$dk.addClass('dk_touch');$dk.find('.dk_options_inner').addClass('scrollable vertical')}e.preventDefault();return false});jQuery('.dk_options a').live((jQuery.browser.msie?'mousedown':'click'),function(e){var $option=jQuery(this),$dk=$option.parents('.dk_container').first(),data=$dk.data('dropkick');_closeDropdown($dk);_updateFields($option,$dk);_setCurrent($option.parent(),$dk);e.preventDefault();return false});jQuery(document).bind('keydown.dk_nav',function(e){var $open=jQuery('.dk_container.dk_open'),$focused=jQuery('.dk_container.dk_focus'),$dk=null;if($open.length){$dk=$open}else if($focused.length&&!$open.length){$dk=$focused}if($dk){_handleKeyBoardNav(e,$dk)}})})})}})();